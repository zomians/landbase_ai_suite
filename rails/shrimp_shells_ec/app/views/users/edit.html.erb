<div class="wrapper grid-container py-12 space-y-10 md:space-y-14">
  <%= render 'shared/error_messages', target: @user %>

  <div class="col-span-full space-y-4">
    <h1 class="font-serif text-h4 md:text-h3"><%= t('spree.my_account') %></h1>

    <div class="flex flex-wrap flex-auto gap-4">
      <%= @user.email %>
      <%= form_with(url: logout_path, method: Devise.sign_out_via, local: true) do %>
        <%= button_tag(t("spree.logout"), class: 'transition-all duration-300 text-black hover:!text-red-500 dark:text-sand underline') %>
      <% end %>
    </div>
  </div>

  <div class="col-span-full grid-container">
    <%= render 'users/users_menu' %>
    <div class="col-span-full md:col-span-10 md:col-start-3" id="edit-account">
      <h2 class="font-serif text-h4 md:text-h4 mb-6"><%= t('spree.editing_user') %></h2>

      <div class="grid grid-container">
        <%= form_for @user, html: { class: "space-y-8 mb-12 col-span-full" } do |f| %>

          <!-- 基本情報セクション -->
          <div class="bg-white dark:bg-gray-900 rounded-xl border border-gray-300 dark:border-gray-700 p-6">
            <h3 class="text-lg font-bold mb-4"><%= t('spree.basic_information') %></h3>
            
            <div class="space-y-4">
              <div class="text-input">
                <%= f.label :email, "#{t('spree.email')}:" %>
                <%= f.email_field :email, class: 'w-full' %>
              </div>

              <div class="text-input">
                <%= f.label :password, "#{t('spree.password')}:" %>
                <%= f.password_field :password, class: 'w-full', placeholder: t('spree.leave_blank_to_keep_current') %>
              </div>

              <div class="text-input">
                <%= f.label :password_confirmation, "#{t('spree.confirm_password')}:" %>
                <%= f.password_field :password_confirmation, class: 'w-full' %>
              </div>
            </div>
          </div>

          <!-- アレルギー・食事制限セクション -->
          <div class="bg-white dark:bg-gray-900 rounded-xl border border-gray-300 dark:border-gray-700 p-6">
            <h3 class="text-lg font-bold mb-4"><%= t('spree.allergy_information') %></h3>
            
            <div class="space-y-4">
              <div class="text-input">
                <%= f.label :allergies, "#{t('spree.allergies')}:" %>
                <%= f.text_area :allergies, rows: 3, class: 'w-full', placeholder: t('spree.allergies_placeholder') %>
                <p class="text-sm text-gray-600 dark:text-gray-400 mt-1"><%= t('spree.allergies_help') %></p>
              </div>

              <div class="text-input">
                <%= f.label :dietary_restrictions, "#{t('spree.dietary_restrictions')}:" %>
                <%= f.text_area :dietary_restrictions, rows: 3, class: 'w-full', placeholder: t('spree.dietary_restrictions_placeholder') %>
                <p class="text-sm text-gray-600 dark:text-gray-400 mt-1"><%= t('spree.dietary_restrictions_help') %></p>
              </div>
            </div>
          </div>

          <!-- デフォルト配送設定セクション -->
          <div class="bg-white dark:bg-gray-900 rounded-xl border border-gray-300 dark:border-gray-700 p-6">
            <h3 class="text-lg font-bold mb-4"><%= t('spree.default_delivery_settings') %></h3>
            
            <div class="space-y-4">
              <div class="text-input">
                <%= f.label :preferred_carrier, "#{t('spree.preferred_carrier')}:" %>
                <%= f.select :preferred_carrier, 
                    options_for_select([
                      [t('spree.carrier_yamato'), 'yamato'],
                      [t('spree.carrier_sagawa'), 'sagawa'],
                      [t('spree.carrier_japan_post'), 'japan_post']
                    ], @user.preferred_carrier), 
                    { include_blank: t('spree.no_preference') },
                    class: 'w-full' %>
              </div>

              <div class="text-input">
                <%= f.label :preferred_delivery_time, "#{t('spree.preferred_delivery_time')}:" %>
                <%= f.select :preferred_delivery_time,
                    options_for_select([
                      [t('spree.time_morning'), 'morning'],
                      [t('spree.time_afternoon'), 'afternoon'],
                      [t('spree.time_evening'), 'evening']
                    ], @user.preferred_delivery_time),
                    { include_blank: t('spree.no_preference') },
                    class: 'w-full' %>
              </div>
            </div>
          </div>

          <!-- 通知設定セクション -->
          <div class="bg-white dark:bg-gray-900 rounded-xl border border-gray-300 dark:border-gray-700 p-6">
            <h3 class="text-lg font-bold mb-4"><%= t('spree.notification_settings') %></h3>
            
            <div class="space-y-3">
              <div class="flex items-center">
                <%= f.check_box :newsletter_subscribed, class: 'mr-2' %>
                <%= f.label :newsletter_subscribed, t('spree.subscribe_to_newsletter'), class: 'cursor-pointer' %>
              </div>

              <div class="flex items-center">
                <%= f.check_box :dm_allowed, class: 'mr-2' %>
                <%= f.label :dm_allowed, t('spree.allow_dm'), class: 'cursor-pointer' %>
              </div>
            </div>
          </div>

          <!-- 顧客メモセクション -->
          <div class="bg-white dark:bg-gray-900 rounded-xl border border-gray-300 dark:border-gray-700 p-6">
            <h3 class="text-lg font-bold mb-4"><%= t('spree.customer_memo') %></h3>
            
            <div class="text-input">
              <%= f.text_area :customer_memo, rows: 4, class: 'w-full', placeholder: t('spree.customer_memo_placeholder') %>
              <p class="text-sm text-gray-600 dark:text-gray-400 mt-1"><%= t('spree.customer_memo_help') %></p>
            </div>
          </div>

          <!-- 更新ボタン -->
          <div class="flex justify-end">
            <%= f.button t("spree.update"),
              name: :commit,
              class: 'py-3 px-7 rounded-full text-body-sm font-bold leading-none uppercase whitespace-nowrap transiton-colors duration-200 bg-red-500 text-white hover:bg-red-700'
            %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
