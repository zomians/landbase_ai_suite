<% order = order_form.object %>

<div class="cart-delivery-info bg-white dark:bg-gray-900 rounded-lg p-6 mb-6 border border-gray-200 dark:border-gray-700">
  <h3 class="text-lg font-bold mb-4 text-gray-900 dark:text-white">
    <%= t('spree.delivery_information') %>
  </h3>

  <div class="space-y-4">
    <!-- 配送希望日選択 (2日後以降) -->
    <div>
      <%= order_form.label :preferred_delivery_date, t('spree.preferred_delivery_date'), class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" %>
      <%= order_form.date_field :preferred_delivery_date, 
        min: (Date.today + 2.days).to_s,
        class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white",
        data: { 
          controller: "delivery-date",
          action: "change->delivery-date#validateDate"
        } %>
      <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">
        <%= t('spree.delivery_date_note') %>
      </p>
    </div>

    <!-- 配送時間帯選択 -->
    <div>
      <%= order_form.label :preferred_delivery_time, t('spree.preferred_delivery_time'), class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" %>
      <%= order_form.select :preferred_delivery_time, 
        Spree::Order::DELIVERY_TIME_SLOTS,
        { include_blank: t('spree.select_time_slot') },
        class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white" %>
    </div>

    <!-- 配送業者選択 -->
    <div>
      <%= order_form.label :carrier_code, t('spree.carrier'), class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" %>
      <%= order_form.select :carrier_code,
        options_for_select(Spree::Order::CARRIER_CODES.map { |k, v| [v, k] }, order.carrier_code),
        { include_blank: t('spree.select_carrier') },
        class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white" %>
    </div>

    <!-- アレルギー確認チェックボックス -->
    <div class="border-t pt-4">
      <div class="flex items-start">
        <div class="flex items-center h-5">
          <%= order_form.check_box :allergies_confirmed,
            class: "w-4 h-4 border-gray-300 rounded text-blue-600 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-800",
            data: {
              controller: "allergie-check",
              action: "change->allergie-check#validate"
            } %>
        </div>
        <div class="ml-3 text-sm">
          <%= order_form.label :allergies_confirmed, class: "font-medium text-gray-700 dark:text-gray-300" do %>
            <%= t('spree.allergies_confirmation') %>
            <span class="text-red-500">*</span>
          <% end %>
          <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">
            <%= t('spree.allergies_confirmation_note') %>
          </p>
        </div>
      </div>
    </div>

    <!-- 配送メモ -->
    <div>
      <%= order_form.label :special_instructions, t('spree.delivery_notes'), class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1" %>
      <%= order_form.text_area :special_instructions,
        rows: 3,
        placeholder: t('spree.delivery_notes_placeholder'),
        class: "w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-2 focus:ring-blue-500 dark:bg-gray-800 dark:text-white" %>
      <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">
        <%= t('spree.delivery_notes_example') %>
      </p>
    </div>
  </div>
</div>
